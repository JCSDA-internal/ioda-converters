# (C) Copyright 2020 NOAA/NWS/NCEP/EMC
#
# This software is licensed under the terms of the Apache Licence Version 2.0
# which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.

observations:
  - obs space:
      name: bufr
      obsdatain: "./testinput/bufr_satwnd_new_format.bufr"
      mnemonicSets:
        - mnemonics: [SAID, CLATH, CLONH, YEAR, MNTH, DAYS, HOUR, MINU, SECO, SWCM, SAZA, OGCE, SCCF, SWQM]
        - mnemonics: [EHAM, PRLC, WDIR, WSPD]
        - mnemonics: [TCOV, CVWD]
        - mnemonics: [GNAPS, PCCF]
          channels: 1-12

      exports:
        filters:
          - bounding:
              mnemonic: CLONH
              lowerBound: -180
              upperBound: 180
        variables:
          satelliteIdentifier:
            mnemonic: SAID
          timestamp:
            datetime:
              year: YEAR
              month: MNTH
              day: DAYS
              hour: HOUR
              minute: MINU
              second: SECO
          longitude:
            mnemonic: CLONH
          latitude:
            mnemonic: CLATH
          windComputationMethod:
            mnemonic: SWCM
          sensorZenithAngle:
            mnemonic: SAZA
          sensorCentralFrequency:
            mnemonic: SCCF
          dataProviderOrigin:
            mnemonic: OGCE
          generatingApplication:
            mnemonic: GNAPS
          qualityFlags:
            mnemonic: SWQM
          windHeightAssignMethod:
            mnemonic: EHAM
          windTrackingCorrelation:
            mnemonic: TCOV
          windPercentConfidence:
            mnemonic: PCCF
          pressure:
            mnemonic: PRLC
          windDirection:
            mnemonic: WDIR
          windSpeed:
            mnemonic: WSPD

    ioda:
      backend: netcdf
      obsdataout: "./testrun/NC005031.nc"

      dimensions:
        - name: "Location"
          size: variables/windSpeed.nrows
        - name: "Confidence"
          size: variables/windPercentConfidence.ncols

      variables:
        - name: "MetaData/satelliteIdentifier"
          source: variables/satelliteIdentifier
          dimensions: [ "Location" ]
          longName: "Satellite Identifier"
          units: ""

        - name: "MetaData/dateTime"
          source: variables/timestamp
          dimensions: [ "Location" ]
          longName: "dateTime"
          units: "seconds since 1970-01-01T00:00:00Z"

        - name: "MetaData/longitude"
          source: variables/longitude
          dimensions: ["Location"]
          longName: "Longitude"
          units: "degrees_east"
          range: [-180, 180]

        - name: "MetaData/latitude"
          source: variables/latitude
          dimensions: ["Location"]
          longName: "Latitude"
          units: "degrees_north"
          range: [-90, 90]

        - name: "MetaData/sensorCentralFrequency"
          source: variables/sensorCentralFrequency
          dimensions: [ "Location" ]
          longName: "Satellite Channel Center Frequency"
          units: "Hz"

        - name: "MetaData/windComputationMethod"
          source: variables/windComputationMethod
          dimensions: [ "Location" ]
          longName: "Satellite Wind Calculation Method"
          units: ""

        - name: "MetaData/sensorZenithAngle"
          source: variables/sensorZenithAngle
          dimensions: [ "Location" ]
          longName: "Satellite Zenith Angle"
          units: "degrees"

        - name: "MetaData/dataProviderOrigin"
          source: variables/dataProviderOrigin
          dimensions: [ "Location" ]
          longName: "Originating/Generating Center"
          units: ""

        - name: "MetaData/qualityFlags"
          source: variables/qualityFlags
          dimensions: [ "Location" ]
          longName: "Satellite Wind Quality Mark"
          units: ""

        - name: "MetaData/windHeightAssignMethod"
          source: variables/windHeightAssignMethod
          dimensions: [ "Location" ]
          longName: "Height Assignment Method"
          units: ""

        - name: "MetaData/windTrackingCorrelation"
          source: variables/windTrackingCorrelation
          dimensions: [ "Location" ]
          longName: "Tracking Correlation of Vector"
          units: "1"

        - name: "MetaData/generatingApplication"
          source: variables/generatingApplication
          dimensions: [ "Location" ]
          longName: "Generating Application"
          units: ""

        - name: "MetaData/windPercentConfidence"
          source: variables/windPercentConfidence
          dimensions: [ "Location",  "Confidence"]
          longName: "Percent Confidence"
          units: "percent"

        - name: "MetaData/pressure"
          source: variables/pressure
          coordinates: "longitude latitude"
          dimensions: [ "Location" ]
          longName: "Pressure"
          units: "Pa"

        - name: "ObsValue/windDirection"
          source: variables/windDirection
          coordinates: "longitude latitude"
          dimensions: [ "Location" ]
          longName: "Wind Direction"
          units: "degrees"

        - name: "ObsValue/windSpeed"
          source: variables/windSpeed
          coordinates: "longitude latitude"
          dimensions: [ "Location" ]
          longName: "Wind Speed"
          units: "m s-1"
