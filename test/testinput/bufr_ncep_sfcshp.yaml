# (C) Copyright 2020 NOAA/NWS/NCEP/EMC
#
# This software is licensed under the terms of the Apache Licence Version 2.0
# which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.

observations:
  - obs space:
      name: bufr
      obsdatain: "./testinput/gdas.t12z.sfcshp.tm00.bufr_d.2020110112"

      exports:
        variables:
          timestamp:
            datetime:
              year: "*/YEAR[1]"
              month: "*/MNTH[1]"
              day: "*/DAYS[1]"
              hour: "*/HOUR[1]"
              minute: "*/MINU[1]"

          reportIdentifier:
            query: "*/RPID"

          stationElevation:
            query: "*/SELV"

          stationPressure:
            query: "*/PRES"

          longitude:
            query: "[*/CLONH,*/CLON]"

          latitude:
            query: "[*/CLATH,*/CLAT]"

          airTemperature:
            query: "[*/TMDB,NC001005/TIDE3/TMDB]"

          dewpointTemperature:
            query: "*/TMDP"

          presentWeather:
            query: "*/PPWSQ1/PRWE"

          depthInstruments:
            query: "NC001103/DBSSX"

          waterTemperatureMethod:
            query: "*/SST_INFO/MSST"

          sst:
            query: "[*/SST1,*/BBYSSTS/SST0,*/SST0,*/TIDE1/SST1]"

          sss:
            query: "NC001102/BBYSSTS/SSS0"
          
          depthBelowWaterSurface:
            query: "[NC001002/DTSCUR/DBSS,*/IDMSMDBS/BBYSTSL/DBSS]" 

          waterTemperature:
            query: "*/IDMSMDBS/BBYSTSL/SST1"

          waterSalinity:
            query: "*/IDMSMDBS/BBYSTSL/SALN"

          windDirection:
            query: "[*/WDIR,NC001002/WNDSQ4/WDIR,NC001005/TIDE3/WDIR]"

          windSpeed:
            query: "[*/WSPD,NC001002/WNDSQ4/WSPD,NC001005/TIDE3/WSPD]"

          verticalSignificanceSurfaceObservations:
            query: "*/CLDSQ1/VSSO"

          cloudAmount:
            query: "*/CLDSQ1/CLAM"

          cloudType:
            query: "*/CLDSQ1/CLTP"

          heightOfBaseOfCloud:
            query: "*/CLDSQ1/HOCB"

          cloudCoverTotal:
            query: "*/TOCC"
            transforms: 
               - scale: 0.01
          heightAboveSurfaceofBaseofLowestCloud:
            query: "*/HBLCS"
    
    ioda:
      backend: netcdf
      obsdataout: "./testrun/gdas.t12z.sfcshp.tm00.bufr_d.2020110112.nc"

#      dimensions:
#        - name: nchans
#          paths:
#            - "*/BRIT"
#            - "*/BRITCSTC"

#      globals: 
#        - name: "MetaData/dataType"
#          type: string
#          value: "sfcshp"
            
      variables:
        - name: "MetaData/dateTime"
          source: variables/timestamp
          longName: "dateTime"
          units: "seconds since 1970-01-01T00:00:00Z"

        - name: "MetaData/latitude"
          source: variables/latitude
          longName: "Latitude"
          units: "degree_north"
          range: [-90, 90]

        - name: "MetaData/longitude"
          source: variables/longitude
          longName: "Longitude"
          units: "degree_east"
          range: [-180, 180]

        - name: "MetaData/reportIdentifier"
          source: variables/reportIdentifier
          longName: "Report Identifier"

        - name: "MetaData/stationElevation"
          coordinates: "longitude latitude"
          source: variables/stationElevation
          longName: "Height of Station"
          units: "m"

        - name: "ObsValue/stationPressure"
          coordinates: "longitude latitude"
          source: variables/stationPressure
          longName: "Station Pressure"
          units: "Pa"
          range: [90000, 105000]

        - name: "ObsValue/presentWeather"
          coordinates: "longitude latitude"
          source: variables/presentWeather
          longName: "Present Weather"

        - name: "ObsValue/airTemperature"
          source: variables/airTemperature
          longName: "Temperature of Air"
          units: "K"
          range: [230, 315]

        - name: "ObsValue/dewpointTemperature"
          coordinates: "longitude latitude"
          source: variables/dewpointTemperature
          longName: "Dewpoint Temperature"
          units: "K"
          range: [200, 315]

        - name: "MetaData/waterTemperatureMethod"
          coordinates: "longitude latitude"
          source: variables/waterTemperatureMethod
          longName: "Method of Sea Surface Measurement"

        - name: "ObsValue/seaSurfaceTemperature"
          coordinates: "longitude latitude"
          source: variables/sst
          longName: "Sea Surface Temperature"
          units: "K"
          range: [260, 315]

        - name: "ObsValue/seaSurfaceSalinity"
          coordinates: "longitude latitude"
          source: variables/sss
          longName: "Sea Surface Salinity"
          units: "parts/1000"
          range: [20, 50]

        - name: "ObsValue/depthBelowWaterSurface"
          coordinates: "longitude latitude"
          source: variables/depthBelowWaterSurface
          longName: "Depth Below Water Surface"
          units: "m"
#         range: [-2000, 0]

        - name: "QualityMarker/verticalSignificanceSurfaceObservations"
          coordinates: "longitude latitude"
          source: variables/verticalSignificanceSurfaceObservations
          longName: "Vertical Significance (Surface Observations)"

        - name: "ObsValue/cloudAmount"
          coordinates: "longitude latitude"
          source: variables/cloudAmount
          longName: "Cloud Amount"
          units: "1"

        - name: "MetaData/cloudType"
          coordinates: "longitude latitude"
          source: variables/cloudType
          longName: "Cloud Type"

        - name: "ObsValue/heightOfBaseOfCloud"
          coordinates: "longitude latitude"
          source: variables/heightOfBaseOfCloud
          longName: "Height of Base of Cloud"
          units: "m"

        - name: "ObsValue/cloudCoverTotal"
          coordinates: "longitude latitude"
          source: variables/cloudCoverTotal
          longName: "Total Cloud Coverage"
          units: "1"

        - name: "ObsValue/heightAboveSurfaceofBaseofLowestCloud"
          coordinates: "longitude latitude"
          source: variables/heightAboveSurfaceofBaseofLowestCloud
          longName: "Height above Surface of Base of Lowest Cloud"

